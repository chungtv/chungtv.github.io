<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Bảng tạm trong MS SQL Server – Temporary tables in MS SQL Server &#8211; Chung Trịnh's Blog</title>
<meta name="description" content="Describe your website here.">
<meta name="keywords" content="MS SQL Server">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://chungtrinh.com/images/">
<meta name="twitter:title" content="Bảng tạm trong MS SQL Server – Temporary tables in MS SQL Server">
<meta name="twitter:description" content="Describe your website here.">
<meta name="twitter:creator" content="@trinhvanchung">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Bảng tạm trong MS SQL Server – Temporary tables in MS SQL Server">
<meta property="og:description" content="Describe your website here.">
<meta property="og:url" content="http://chungtrinh.com/work/tutorials/2012/05/23/bang-tam-trong-ms-sql-server-temporary-tables-in-ms-sql-server.html">
<meta property="og:site_name" content="Chung Trịnh's Blog">





<link rel="canonical" href="http://chungtrinh.com/work/tutorials/2012/05/23/bang-tam-trong-ms-sql-server-temporary-tables-in-ms-sql-server.html">
<link href="http://chungtrinh.com/feed.xml" type="application/atom+xml" rel="alternate" title="Chung Trịnh's Blog Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://chungtrinh.com/assets/css/main.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://chungtrinh.com/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://chungtrinh.com/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://chungtrinh.com/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://chungtrinh.com/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://chungtrinh.com/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://chungtrinh.com/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://chungtrinh.com/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post" >

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="http://chungtrinh.com/">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="http://chungtrinh.com/images/avatar.jpg" alt="Chung Trịnh photo" class="author-img">
					<h4>Chung Trịnh</h4>
					<p>Business software Developer and Bloger.</p>
				</li>
				<li>
					<a href="http://chungtrinh.com/about/"><i class="fa fa-fw fa-user"></i> About me</a>
				</li>
				<li>
					<a href="mailto:aschungtv@gmail.com"><i class="fa fa-fw fa-envelope"></i> Email</a>
				</li>
				<li>
					<a href="https://twitter.com/trinhvanchung" target="_blank"><i class="fa fa-fw fa-twitter"></i> Twitter</a>
				</li>
				<li>
					<a href="https://facebook.com/chungtv" target="_blank"><i class="fa fa-fw fa-facebook"></i> Facebook</a>
				</li>
				
				<li>
					<a href="https://linkedin.com/in/chungtv" target="_blank"><i class="fa fa-fw fa-linkedin"></i> LinkedIn</a>
				</li>
				<li>
					<a href="https://github.com/chungtv" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a>
				</li>
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="http://chungtrinh.com/posts/">All Posts</a></li>
				<li><a href="http://chungtrinh.com/categories/">All Categories</a></li>
				<li><a href="http://chungtrinh.com/tags/">All Tags</a></li>
			</ul>
		</li>
		
	    
	    <li><a href="http://chungtrinh.com/categories/#Work" >Works</a></li>
	  
	    
	    <li><a href="http://chungtrinh.com/categories/#Life" >Life</a></li>
	  
	    
	    <li><a href="http://chungtrinh.com/tools/" >Tools</a></li>
	  
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->




<div id="main" role="main">
  <article class="hentry">
    <header class="header-title">
      <div class="header-title-wrap">
        
          <h1 class="entry-title"><a href="http://chungtrinh.com/work/tutorials/2012/05/23/bang-tam-trong-ms-sql-server-temporary-tables-in-ms-sql-server.html" rel="bookmark" title="Bảng tạm trong MS SQL Server – Temporary tables in MS SQL Server">Bảng tạm trong MS SQL Server – Temporary tables in MS SQL Server</a></h1>
        
        <h2><span class="entry-date date published"><time datetime="2012-05-23T05:00:00+07:00">May 23, 2012</time></span></h2>
        
        <p class="entry-reading-time">
          <i class="fa fa-clock-o"></i>
          
Reading time ~2 minutes
        </p><!-- /.entry-reading-time -->
        
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content">
      <p>Khi làm việc với MS SQL Server, hẳn bạn cũng khá quen thuộc với khái niệm bảng tạm (Temporary table). Ít nhiều bạn đã từng làm hoặc từng gặp các đoạn:</p>

<p><code class="highlighter-rouge">sql
SELECT Col1, Col2 INTO #tTmpTable FROM TableName WHERE ...
</code></p>

<p>hay</p>

<p><code class="highlighter-rouge">sql
CREATE TABLE #tTmpTable (col1 varchar(8), ...)
</code></p>

<p>Trong bài viết này mình xin trình bày với các bạn cái nhìn tổng quan về Temporary table.</p>

<h3 id="cc-loi-bng-tm">Các loại bảng tạm</h3>
<p>MS SQL Server cung cấp cho chúng ta 2 loại bảng tạm là <strong>Local Temporary table</strong> và <strong>Global Temporary table</strong>. Mỗi loại bảng tạm có phạm vi ảnh hưởng và truy cập khác nhau.</p>

<p><strong>Local temporary table</strong> là bảng tạm được tạo ra và tồn tại trong 1 kết nối. Khi kết thúc kết nối thì bảng tạm này sẽ tự động được xóa. Tên của bảng tạm kiểu Local được bắt đầu bằng ký tự #.</p>

<p><strong>Global temporary table</strong> là bảng tạm có phạm vi ảnh hưởng trong tất cả các kết nối và nó chỉ tự động được xóa đi khi tất cà kết nối đã được ngắt. Tên bảng tạm kiểu Global được bắt đầu  bằng ##.</p>

<p>Để minh chứng cho 2 loại bảng tạm này, các bạn hãy làm thử ví dụ sau:</p>

<ul>
  <li>Mở Microsoft SQL Server Management Studio (SSMS) và chọn <kbd>New Query</kbd></li>
  <li>Gõ đoạn lệnh sau:</li>
</ul>

<p><code class="highlighter-rouge">sql
CREATE TABLE #LocalTmpTable
(
    ID int,
    Name nvarchar(32)
)
</code></p>

<p>Đoạn lệnh này sẽ tạo ra trong Database <strong>tempdb</strong> một bảng có tên là #LocalTmpTable____000002</p>

<p><img src="http://trinhvanchung.files.wordpress.com/2012/04/image.png" alt="" /></p>

<p>SQL Server sẽ tự động tăng số thứ tự vào phía sau tên bảng nhằm quản lý việc nhiều kết nối tạo bảng tạm có cùng tên.</p>

<ul>
  <li>Gõ đoạn sau và <kbd>F5</kbd> để kiểm tra, bạn sẽ nhận được kết quả là ID của bảng tạm đã tạo.</li>
</ul>

<p><code class="highlighter-rouge">sql
PRINT OBJECT_ID('Tempdb.dbo.#LocalTmpTable')
</code></p>

<ul>
  <li>Mở 1 cửa sổ Query khác bằng <kbd>New Query</kbd>, gõ lại đoạn lệnh trên và <kbd>F5</kbd> bạn sẽ không nhận được kết quả.</li>
</ul>

<p>Để Test về phạm vi của <strong>Global Temp table</strong>, bạn hãy thực hiện lại các thao tác trên với tên bảng là ##GlobalTmpTable.</p>

<h3 id="to-v-thao-tc-trn-bng-tm">Tạo và thao tác trên bảng tạm</h3>
<p>Để tạo bảng tạm, bạn có thể sử dụng lệnh <code class="highlighter-rouge">CREATE TABLE</code></p>

<p><code class="highlighter-rouge">sql
CREATE TABLE #LocalTmpTable ( ID int, Name nvarchar(32))
</code></p>

<p>hoặc sử dụng lệnh SELECT INTO</p>

<p><code class="highlighter-rouge">sql
SELECT Ma, Ten INTO ##GlobalTmpTable FROM TableName WHERE ...
</code></p>

<p>Với <code class="highlighter-rouge">Temporary Table</code>, bạn  hoàn toàn có thể truy vấn, thao tác dữ liệu như đối với các table bình thường.</p>

<h3 id="s-dng-bng-tm">Sử dụng bảng tạm</h3>
<p>Bảng tạm và biến bảng thường được sử dụng khi cần xử lý một tập dữ liệu con trong tạp dữ liệu lớn được lưu trữ trong Table của Database hoặc từ nhiều Tables. (Đặc biệt là khi viết các Store procedures xử lý báo cáo).</p>

<p>Bảng tạm được tạo ra trong Database Tempdb khác với Database của bạn vì thế có thể gây ra các vấn đề về hiệu suất. Do đó, bạn cần tính toán kỹ số lượng các Fields cần thiết phải lấy ra.</p>

<h3 id="tham-kho">Tham khảo</h3>
<ul>
  <li><a href="http://www.codeproject.com/Articles/42553/Quick-Overview-Temporary-Tables-in-SQL-Server-2005">Quick Overview: Temporary Tables in SQL Server 2005</a></li>
</ul>

      <footer class="entry-meta">
        <span class="entry-tags"><a href="http://chungtrinh.com/tags/#MS SQL Server" title="Pages tagged MS SQL Server" class="tag"><span class="term">MS SQL Server</span></a></span>
        
        <div class="social-share">
  <ul class="socialcount socialcount-small inline-list">
    <li class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=http://chungtrinh.com/work/tutorials/2012/05/23/bang-tam-trong-ms-sql-server-temporary-tables-in-ms-sql-server.html" title="Share on Facebook"><span class="count"><i class="fa fa-facebook-square"></i> Like</span></a></li>
    <li class="twitter"><a href="https://twitter.com/intent/tweet?text=http://chungtrinh.com/work/tutorials/2012/05/23/bang-tam-trong-ms-sql-server-temporary-tables-in-ms-sql-server.html" title="Share on Twitter"><span class="count"><i class="fa fa-twitter-square"></i> Tweet</span></a></li>
    <li class="googleplus"><a href="https://plus.google.com/share?url=http://chungtrinh.com/work/tutorials/2012/05/23/bang-tam-trong-ms-sql-server-temporary-tables-in-ms-sql-server.html" title="Share on Google Plus"><span class="count"><i class="fa fa-google-plus-square"></i> +1</span></a></li>
  </ul>
</div><!-- /.social-share -->
      </footer>
    </div><!-- /.entry-content -->
    <section id="disqus_thread"></section><!-- /#disqus_thread -->
    <div class="read-more">
  
    <div class="read-more-header">
      <a href="http://chungtrinh.com/life/2012/05/18/bi3-oc-sen.html" class="read-more-btn">Read More</a>
    </div><!-- /.read-more-header -->
    <div class="read-more-content">
      <h3><a href="http://chungtrinh.com/work/tips%20and%20tricks/2015/10/23/thay-%C4%91%E1%BB%95i-%C4%91%C6%B0%E1%BB%9Dng-d%E1%BA%ABn-local-trong-team-foundation-server.html" title="Thay đổi đường dẫn Local trong Team Foundation Server">Thay đổi đường dẫn Local trong Team Foundation Server</a></h3>
      <p>Đôi khi vì lý do gì đó bạn cần thay đổi đường dẫn `Local path` đã được map bởi Team Foundation Server Source control. Để thực hiện việc n...&hellip; <a href="http://chungtrinh.com/work/tips%20and%20tricks/2015/10/23/thay-%C4%91%E1%BB%95i-%C4%91%C6%B0%E1%BB%9Dng-d%E1%BA%ABn-local-trong-team-foundation-server.html">Continue reading</a></p>
    </div><!-- /.read-more-content -->
  
  <div class="read-more-list">
    
      <div class="list-item">
        <h4><a href="http://chungtrinh.com/work/tips%20and%20tricks/2015/10/16/s%E1%BB%ADa-l%E1%BB%97i-unable-to-modify-table-timeout-expired-trong-sql-server-management-studio.html" title="Sửa lỗi Unable to modify table. Timeout expired trong SQL Server Management Studio">Sửa lỗi Unable to modify table. Timeout expired trong SQL Server Management Studio</a></h4>
        <span>Published on October 16, 2015</span>
      </div><!-- /.list-item -->
    
      <div class="list-item">
        <h4><a href="http://chungtrinh.com/work/tips%20and%20tricks/2015/08/04/start-menu-cotana-va-modern-apps-khong-hoat-dong-trong-windows-10.html" title="Start menu, Cotana và Modern Apps không hoạt động trong windows 10">Start menu, Cotana và Modern Apps không hoạt động trong windows 10</a></h4>
        <span>Published on August 04, 2015</span>
      </div><!-- /.list-item -->
    
  </div><!-- /.read-more-list -->
</div><!-- /.read-more -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2016 Chung Trịnh. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="https://mademistakes.com/work/hpstr-jekyll-theme/" rel="nofollow">HPSTR Theme</a>.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://chungtrinh.com/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://chungtrinh.com/assets/js/scripts.min.js"></script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-62079859-1', 'auto');  
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>



    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'chungtrinh'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	        

</body>
</html>
